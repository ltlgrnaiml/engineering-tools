{
  "schema_type": "spec",
  "id": "SPEC-0039_sov-visualization-contracts",
  "title": "SOV Visualization Contracts Specification",
  "version": "0.1.0",
  "status": "draft",
  "date": "2025-12-27",
  "author": "Mycahya Eggleston",
  "implements_adr": [
    "ADR-0024_SOV-Visualization-Contracts",
    "ADR-0028_Unified-Rendering-Engine"
  ],
  "tier_0_contracts": [
    {
      "module": "shared.contracts.sov.visualization",
      "classes": [
        "SOVVisualizationType",
        "BoxPlotConfig",
        "InteractionPlotConfig",
        "ResidualPlotConfig"
      ]
    },
    {
      "module": "shared.contracts.core.rendering",
      "classes": [
        "ChartSpec",
        "RenderStyle",
        "DataSeries"
      ]
    }
  ],
  "purpose": "Define SOV-specific visualization contracts that extend the unified rendering engine. SOV visualizations include ANOVA-specific plots (interaction, main effects, residuals) that inherit from shared ChartSpec.",
  "scope": "subsystem:SOV",
  "requirements": [
    {
      "id": "REQ-VIZ-001",
      "description": "SOV visualization contracts MUST extend ChartSpec from unified engine",
      "reference": "ADR-0029"
    },
    {
      "id": "REQ-VIZ-002",
      "description": "Backend MUST produce visualization-ready contracts",
      "rationale": "Frontend renders directly from contracts without statistical computation"
    },
    {
      "id": "REQ-VIZ-003",
      "description": "Contracts MUST be consumable by PPTX Generator",
      "flow": "SOV → ChartSpec → PPTX Renderer"
    }
  ],
  "sov_visualization_types": [
    {
      "type": "INTERACTION_PLOT",
      "description": "Factor interaction visualization"
    },
    {
      "type": "MAIN_EFFECTS_PLOT",
      "description": "Main effects for each factor"
    },
    {
      "type": "RESIDUAL_PLOT",
      "description": "Residuals vs fitted values"
    },
    {
      "type": "NORMAL_PROBABILITY_PLOT",
      "description": "Q-Q plot for residuals"
    },
    {
      "type": "VARIANCE_BAR",
      "description": "Variance component bar chart"
    },
    {
      "type": "BOX_PLOT",
      "description": "Box plot by factor levels"
    }
  ],
  "integration_with_unified_engine": {
    "inheritance": "SOV visualization configs extend ChartSpec",
    "styling": "Uses RenderStyle from unified engine",
    "output_targets": "Supports all OutputTarget values (web, PNG, PPTX)"
  },
  "references": [
    "ADR-0024_SOV-Visualization-Contracts: Visualization contracts",
    "ADR-0028_Unified-Rendering-Engine: Unified rendering",
    "SPEC-0031_Unified-Rendering-Contracts: ChartSpec hierarchy",
    "shared/contracts/sov/visualization.py: Tier-0 contracts"
  ]
}