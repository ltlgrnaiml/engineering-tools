{
  "schema_type": "spec",
  "id": "SPEC-0037_pptx-renderer-interface",
  "title": "PPTX Renderer Interface Specification",
  "version": "0.1.0",
  "status": "draft",
  "date": "2025-12-27",
  "author": "Mycahya Eggleston",
  "implements_adr": [
    "ADR-0021_PPTX-Renderer-Architecture",
    "ADR-0028_Unified-Rendering-Engine"
  ],
  "tier_0_contracts": [
    {
      "module": "shared.contracts.pptx.shape",
      "classes": [
        "ShapeBinding",
        "TextConfig",
        "TableConfig",
        "ChartConfig",
        "ImageConfig"
      ]
    },
    {
      "module": "shared.contracts.core.rendering",
      "classes": [
        "RenderSpec",
        "ChartSpec",
        "TableSpec"
      ]
    }
  ],
  "purpose": "Define the PPTX renderer interface that consumes unified RenderSpecs and populates PowerPoint shapes. Renderers are thin adapters over the shared rendering engine.",
  "scope": "subsystem:PPTX",
  "requirements": [
    {
      "id": "REQ-RENDERER-001",
      "description": "All renderers MUST implement BaseRenderer interface",
      "methods": [
        "can_render(shape)",
        "render(context)"
      ]
    },
    {
      "id": "REQ-RENDERER-002",
      "description": "Renderers MUST consume RenderSpec from unified engine",
      "reference": "ADR-0029"
    },
    {
      "id": "REQ-RENDERER-003",
      "description": "Failed renders MUST log error and continue (graceful degradation)",
      "reference": "ADR-0022"
    }
  ],
  "renderer_types": [
    {
      "type": "PlotRenderer",
      "handles": "ChartSpec → shape image"
    },
    {
      "type": "TableRenderer",
      "handles": "TableSpec → PPTX table"
    },
    {
      "type": "TextRenderer",
      "handles": "TextSpec → text box"
    },
    {
      "type": "ImageRenderer",
      "handles": "ImageSpec → picture placeholder"
    }
  ],
  "integration_with_unified_engine": {
    "description": "PPTX renderers delegate to shared rendering engine",
    "flow": [
      "1. Receive RenderSpec from binding",
      "2. Call shared rendering engine with PPTX_IMAGE target",
      "3. Insert rendered image into shape",
      "4. Apply PPTX-specific formatting"
    ]
  },
  "references": [
    "ADR-0021_PPTX-Renderer-Architecture: Renderer pattern",
    "ADR-0028_Unified-Rendering-Engine: Shared rendering",
    "SPEC-0031_Unified-Rendering-Contracts: RenderSpec contracts"
  ]
}