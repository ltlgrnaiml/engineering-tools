{
  "schema_type": "adr",
  "id": "ADR-0009_audit-trail-timestamps",
  "title": "Audit Trail Timestamps for All Artifacts and Manifests Across All Tools",
  "status": "accepted",
  "date": "2025-11-22",
  "deciders": "Mycahya Eggleston",
  "scope": "core",
  "provenance": [
    {
      "at": "2025-11-22",
      "by": "Mycahya Eggleston",
      "note": "Initial draft"
    },
    {
      "at": "2025-12-27",
      "by": "DevTools Editor",
      "note": "Updated via DevTools ADR Editor"
    }
  ],
  "context": "All engineering tools (DAT, PPTX Generator, SOV Analyzer) produce artifacts (parsed data, generated reports, analysis results, manifests) that require auditability, reproducibility, and compliance with deterministic workflows. Every artifact and manifest must include standardized timestamps to enable traceability for all lifecycle events (creation, locking, unlocking, cancellation, etc.), support CI contract enforcement, and align with best practices for provenance and regulatory requirements. This is a CORE pattern that applies uniformly across all tools to ensure consistent audit trails throughout the platform.",
  "decision_primary": "All artifacts and manifests MUST include ISO-8601 UTC timestamps (no microseconds) for all relevant lifecycle events: created, locked, unlocked, cancelled, etc. CI contract tests MUST enforce presence and correct format of these fields. Timestamps are required for all pipeline stages and persisted outputs.",
  "decision_details": {
    "approach": "Standardize on ISO-8601 UTC timestamps (e.g., 2025-11-22T16:00:00Z, no microseconds). Each artifact/manifest includes fields: created_at, locked_at, unlocked_at, cancelled_at, etc., as applicable. CI contract tests validate presence and format. All timestamps are set by the orchestrator, not by individual stages.",
    "implementation_specs": [
      "SPEC-0012_Audit-Trail-Enforcement-Spec"
    ],
    "tier_0_contracts": [
      "shared/contracts/core/audit.py: AuditTimestamp, AuditTrail, LifecycleEvent, TimestampMixin, now_utc(), to_iso8601()"
    ],
    "constraints": [
      "Timestamps must not include microseconds.",
      "All times must be in UTC.",
      "Timestamps must be present for all relevant lifecycle events.",
      "Setting timestamps must not break determinism or reproducibility."
    ]
  },
  "consequences": [
    "Artifacts and manifests are fully auditable and support deterministic workflows.",
    "CI can enforce contract compliance for all outputs.",
    "Slight increase in schema complexity and test coverage requirements.",
    "Legacy artifacts may require migration to new schema."
  ],
  "alternatives_considered": [
    {
      "name": "No Timestamps",
      "pros": "Simpler schema, less data to manage.",
      "cons": "No audit trail, fails compliance and provenance requirements.",
      "rejected_reason": "Fails core auditability and reproducibility goals."
    },
    {
      "name": "Local Time or Non-Standard Formats",
      "pros": "Easier for local debugging.",
      "cons": "Breaks determinism, complicates cross-system analysis.",
      "rejected_reason": "Non-deterministic and error-prone."
    }
  ],
  "tradeoffs": "Adds minor complexity to schemas and CI, but provides essential auditability and compliance. Determinism is preserved by standardizing on UTC and format.",
  "rollout_plan": [
    "Update schemas and code to add timestamp fields.",
    "Add/extend CI contract tests.",
    "Migrate legacy artifacts as needed.",
    "Communicate changes to all developers and users."
  ],
  "rollback_plan": "Revert schema and code changes; remove timestamp fields and CI checks.",
  "metrics_to_watch": [
    "Percentage of artifacts/manifests with valid timestamps.",
    "CI contract test pass rate for timestamp fields."
  ],
  "guardrails": [
    {
      "rule": "All artifacts and manifests MUST include ISO-8601 UTC timestamps for lifecycle events.",
      "enforcement": "CI contract tests fail if any required timestamp is missing or incorrectly formatted.",
      "scope": "core"
    }
  ],
  "cross_cutting_guardrails": [
    "Deterministic Artifacts: All outputs must be reproducible given the same inputs (see ADR-0045#deterministic-artifacts)"
  ],
  "references": [
    "ADR-0004_Deterministic-Content-Addressed-IDs: Core ID generation uses timestamps for provenance",
    "ADR-0017_Cross-Cutting-Guardrails: Audit trail guardrails",
    "shared/contracts/: All artifact contracts include timestamp fields",
    "ADR-0007",
    "ADR-0016",
    "ADR-0018",
    "ADR-0032",
    "ADR-0035",
    "ADR-0036",
    "ADR-0012",
    "ADR-0025"
  ],
  "tags": [
    "audit-trail",
    "timestamps",
    "provenance",
    "determinism"
  ],
  "affected_components": [
    "artifact schemas",
    "manifest generation",
    "CI contract tests",
    "developer docs"
  ],
  "review_date": "2026-05-22"
}